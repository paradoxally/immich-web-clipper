<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Immich Web Clipper</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <!-- Login View -->
    <div id="login-view" class="view">
      <header>
        <div class="logo">
          <svg width="28" height="28" viewBox="0 0 792 792" xmlns="http://www.w3.org/2000/svg">
            <path fill="#FA2921" d="M375.48,267.63c38.64,34.21,69.78,70.87,89.82,105.42c34.42-61.56,57.42-134.71,57.71-181.3c0-0.33,0-0.63,0-0.91c0-68.94-68.77-95.77-128.01-95.77s-128.01,26.83-128.01,95.77c0,0.94,0,2.2,0,3.72C300.01,209.24,339.15,235.47,375.48,267.63z"/>
            <path fill="#ED79B5" d="M164.7,455.63c24.15-26.87,61.2-55.99,103.01-80.61c44.48-26.18,88.97-44.47,128.02-52.84c-47.91-51.76-110.37-96.24-154.6-110.91c-0.31-0.1-0.6-0.19-0.86-0.28c-65.57-21.3-112.34,35.81-130.64,92.15c-18.3,56.34-14.04,130.04,51.53,151.34C162.05,454.77,163.25,455.16,164.7,455.63z"/>
            <path fill="#FFB400" d="M681.07,302.19c-18.3-56.34-65.07-113.45-130.64-92.15c-0.9,0.29-2.1,0.68-3.54,1.15c-3.75,35.93-16.6,81.27-35.96,125.76c-20.59,47.32-45.84,88.27-72.51,118c69.18,13.72,145.86,12.98,190.26-1.14c0.31-0.1,0.6-0.2,0.86-0.28C695.11,432.22,699.37,358.52,681.07,302.19z"/>
            <path fill="#1E83F7" d="M336.54,510.71c-11.15-50.39-14.8-98.36-10.7-138.08c-64.03,29.57-125.63,75.23-153.26,112.76c-0.19,0.26-0.37,0.51-0.53,0.73c-40.52,55.78-0.66,117.91,47.27,152.72c47.92,34.82,119.33,53.54,159.86-2.24c0.56-0.76,1.3-1.78,2.19-3.01C363.28,602.32,347.02,558.08,336.54,510.71z"/>
            <path fill="#18C249" d="M617.57,482.52c-35.33,7.54-82.42,9.33-130.72,4.66c-51.37-4.96-98.11-16.32-134.63-32.5c8.33,70.03,32.73,142.73,59.88,180.6c0.19,0.26,0.37,0.51,0.53,0.73c40.52,55.78,111.93,37.06,159.86,2.24c47.92-34.82,87.79-96.95,47.27-152.72C619.2,484.77,618.46,483.75,617.57,482.52z"/>
          </svg>
          <h1>Web Clipper</h1>
        </div>
        <button type="button" id="theme-toggle-login" class="icon-btn" title="Toggle theme">
          <svg class="icon-sun" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
          <svg class="icon-moon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
      </header>

      <div id="login-notification" class="notification hidden"></div>

      <form id="login-form">
        <div class="field">
          <label for="server-url">Server URL</label>
          <input type="url" id="server-url" placeholder="https://immich.example.com" required>
        </div>

        <div class="field">
          <label for="api-key">API Key</label>
          <input type="password" id="api-key" placeholder="Enter your API key" required>
          <span class="hint">Account Settings → API Keys</span>
        </div>

        <button type="submit" id="connect-btn" class="btn primary full">Connect</button>
      </form>
    </div>

    <!-- Main View (Connected) -->
    <div id="main-view" class="view hidden">
      <header>
        <div class="logo">
          <svg width="28" height="28" viewBox="0 0 792 792" xmlns="http://www.w3.org/2000/svg">
            <path fill="#FA2921" d="M375.48,267.63c38.64,34.21,69.78,70.87,89.82,105.42c34.42-61.56,57.42-134.71,57.71-181.3c0-0.33,0-0.63,0-0.91c0-68.94-68.77-95.77-128.01-95.77s-128.01,26.83-128.01,95.77c0,0.94,0,2.2,0,3.72C300.01,209.24,339.15,235.47,375.48,267.63z"/>
            <path fill="#ED79B5" d="M164.7,455.63c24.15-26.87,61.2-55.99,103.01-80.61c44.48-26.18,88.97-44.47,128.02-52.84c-47.91-51.76-110.37-96.24-154.6-110.91c-0.31-0.1-0.6-0.19-0.86-0.28c-65.57-21.3-112.34,35.81-130.64,92.15c-18.3,56.34-14.04,130.04,51.53,151.34C162.05,454.77,163.25,455.16,164.7,455.63z"/>
            <path fill="#FFB400" d="M681.07,302.19c-18.3-56.34-65.07-113.45-130.64-92.15c-0.9,0.29-2.1,0.68-3.54,1.15c-3.75,35.93-16.6,81.27-35.96,125.76c-20.59,47.32-45.84,88.27-72.51,118c69.18,13.72,145.86,12.98,190.26-1.14c0.31-0.1,0.6-0.2,0.86-0.28C695.11,432.22,699.37,358.52,681.07,302.19z"/>
            <path fill="#1E83F7" d="M336.54,510.71c-11.15-50.39-14.8-98.36-10.7-138.08c-64.03,29.57-125.63,75.23-153.26,112.76c-0.19,0.26-0.37,0.51-0.53,0.73c-40.52,55.78-0.66,117.91,47.27,152.72c47.92,34.82,119.33,53.54,159.86-2.24c0.56-0.76,1.3-1.78,2.19-3.01C363.28,602.32,347.02,558.08,336.54,510.71z"/>
            <path fill="#18C249" d="M617.57,482.52c-35.33,7.54-82.42,9.33-130.72,4.66c-51.37-4.96-98.11-16.32-134.63-32.5c8.33,70.03,32.73,142.73,59.88,180.6c0.19,0.26,0.37,0.51,0.53,0.73c40.52,55.78,111.93,37.06,159.86,2.24c47.92-34.82,87.79-96.95,47.27-152.72C619.2,484.77,618.46,483.75,617.57,482.52z"/>
          </svg>
          <h1>Web Clipper</h1>
        </div>
        <div class="header-actions">
          <button type="button" id="theme-toggle-main" class="icon-btn" title="Toggle theme">
            <svg class="icon-sun" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="5"/>
              <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
            </svg>
            <svg class="icon-moon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
            </svg>
          </button>
          <button type="button" id="settings-btn" class="icon-btn" title="Settings">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"/>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
            </svg>
          </button>
        </div>
      </header>

      <div class="stats-card">
        <div class="stats-header">
          <div class="connection-status">
            <span class="status-dot" title="Connected"></span>
            <span id="server-name">CONNECTED</span>
          </div>
        </div>
        <div class="stats-grid">
          <div class="stat">
            <span class="stat-value" id="stat-images">0</span>
            <span class="stat-label">Images Saved</span>
          </div>
          <div class="stat">
            <span class="stat-value" id="stat-size">0 B</span>
            <span class="stat-label">Total Size</span>
          </div>
        </div>
      </div>

      <div class="current-album">
        <span class="current-album-label">Saving to</span>
        <span class="current-album-name" id="current-album-name">Library</span>
      </div>

      <button type="button" id="disconnect-btn" class="btn secondary full">Disconnect</button>

      <div class="instruction-text">
        <span>Right-click any image → "Save to Immich"</span>
      </div>

      <footer>
        <a id="footer-github" href="#" target="_blank">GitHub</a>
        <span>•</span>
        <a id="footer-privacy" href="#" target="_blank">Privacy</a>
        <span>•</span>
        <a id="footer-bug" href="#" target="_blank">Report Bug</a>
      </footer>
    </div>

    <!-- Settings View -->
    <div id="settings-view" class="view hidden">
      <header>
        <button type="button" id="back-btn" class="icon-btn" title="Back">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
        </button>
        <h2>Settings</h2>
        <div style="width: 34px;"></div>
      </header>

      <div class="settings-section">
        <h3>Notifications</h3>
        <label class="toggle-row">
          <span>Show save alerts</span>
          <input type="checkbox" id="setting-alerts" checked>
          <span class="toggle"></span>
        </label>
      </div>

      <div class="settings-section">
        <h3>Album</h3>
        <div class="field">
          <label for="album-select">Default Album</label>
          <select id="album-select">
            <option value="">Library (no album)</option>
          </select>
        </div>
        <label class="toggle-row">
          <span>Choose album each time</span>
          <input type="checkbox" id="setting-ask-album">
          <span class="toggle"></span>
        </label>
        <button type="button" id="refresh-albums" class="btn text">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12a9 9 0 11-2.636-6.364"/>
            <path d="M21 3v6h-6"/>
          </svg>
          Refresh Albums
        </button>
      </div>

      <div class="settings-divider"></div>

      <div class="settings-section">
        <h3>Danger Zone</h3>
        <div class="reset-stats-container">
          <button type="button" id="reset-stats-btn" class="btn danger-text">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
            </svg>
            Reset stats
          </button>
          <div id="reset-confirm" class="reset-confirm hidden">
            <span class="confirm-text">Are you sure?</span>
            <div class="confirm-buttons">
              <button type="button" id="reset-yes" class="btn confirm-yes">Yes</button>
              <button type="button" id="reset-no" class="btn confirm-no">No</button>
            </div>
          </div>
        </div>
      </div>

      <div class="version-info">
        <span id="version-number"></span>
      </div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
